# practice_14

任务二（总分：47分）
任务描述：请基于ZigBee模块（黑板）实现火灾自动报警系统开发。当系统处于自动模式时通过从串口接收模拟的火焰传感器数据，当火焰传感器数据超过预定的值时进行报警。
设备列表：
1、ZigBee模块（黑板）1块+电源线
2、USB转串口线1根
3、CC Debugger仿真器1个
任务要求：
用USB转串口线将ZigBee模块（黑板）连接至PC机的串口。
在 “C:\JoyWork\01\work\Task\”文件夹下创建IAR工程，工程名字和工作空间的名字均为：“Task+准考证号后12位”，把“Task” 文件夹下的“test.c”添加到IAR工程中，配置好工程选项参数，确保工程编译成功。（4分）。在“test.c”中添加代码实现以下功能：（注意：题目中涉及的变量均已在test.c中定义）
1、	系统有两种工作模式：流水灯模式和自动报警模式。
1）	workMode的值为0时是流水灯模式，为 1时是自动报警模式。
2）	通过按键切换workMode的值来改变工作模式。
3）	系统一上电，处于流水灯模式。
2、使用定时器1来产生10ms的定时。定时器1已设置好采用32MHz系统时钟、32分频、模模式、通道0比较模式、比较值T1CC0为10000，此时定时器1每10ms产生一次中断，本部分代码已提供，考生无需处理。
3、系统处于流水灯模式时，4个灯按流水灯的效果闪烁，1个循环周期（4个灯轮流各亮1次）约1000ms时间，要求使用定时器1的中断次数来控制时间。（10分）
4、按键采用查询方式进行检测，上拉输入模式，通过按键切换系统工作模式。（10分）
1）按下SW1后，系统进入自动报警模式，状态指示灯为D3灭，D4亮。
2）再次按下SW1后，系统回到流水灯工作模式。 
5、串口通信要求采用波特率115200bps，8位数据位，1位停止位，无校验位，无流控。（2分）
6、在自动工作模式时，通过串口助手发送模拟的火焰传感数据，范围值为1-300，以‘#’结束。串口使用中断方式接收到数据，将火焰传感数据转换成整数并存放到火焰传感器变量sensorValue中。要求：（18分）
  1）当通过串口助手发送的值大于等于200，比如发送234#，则截取到sensorValue的值为234，当sensorValue>=200，则开启报警（D5，D6同时亮）
2）当通过串口助手发送的值小于200，比如 123#，则关闭报警（D5，D6灭）。
7、编码结束，将程序下载到ZigBee模块中，并验证结果是否正确，把串口助手发送模拟的火焰传感数据及响应进行截图保存至“图集.docx”中的8.png处。 （3分）
8、考试时间截止后，确保“图集.docx”和源码工程文件已保存后， 对work文件夹进行压缩，点击“上传文件”将压缩后的“work.zip”上传至服务器指定目录。
![image](https://user-images.githubusercontent.com/104015167/200778306-8db5a3a6-5315-463a-adae-fdc2edd5feb7.png)
